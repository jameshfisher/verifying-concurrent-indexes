<section class='generated_listing' xmlns='http://www.w3.org/1999/xhtml' xmlns:xi='http://www.w3.org/2001/XInclude' xmlns:e='http://eegg.github.com/htmlx' xmlns:m='http://eegg.github.com/macro'><e:displaycode>module rb.blacken;

import rb.node;

Node* blacken(Node* root) {&#160;</e:displaycode>
<div class='section'><pre class='indent'>&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'>Function precondition.</div><e:or>
  <e:fst><e:pred name="RBT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:fst>
  <e:snd><e:pred name="RVT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:snd>
</e:or></div></div>
<e:displaycode>
  if (root == null) {&#160;</e:displaycode>
<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><e:pred name="ET"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></div></div>

<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'>Weakening</div><e:pred name="BT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></div></div>

<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'>Member of set containing itself</div><e:and>
  <e:fst><e:pred name="BT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:fst>
  <e:snd><e:in>
    <e:fst><e:var n="h"/></e:fst>
    <e:snd><e:set>
      <e:var n="h"/>,
      <e:plus><e:fst><e:var n="h"/></e:fst><e:snd><e:const n="1"/></e:snd></e:plus>
    </e:set></e:snd>
  </e:in></e:snd>
</e:and></div></div>

<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'><m:existsIntro/> on <e:var n="h"/> as <e:var n="nh"/>.</div><e:exists>
  <e:fst><e:var n="nh"/></e:fst>
  <e:snd><e:and>
    <e:fst><e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred></e:fst>
    <e:snd><e:in>
      <e:fst><e:var n="nh"/></e:fst>
      <e:snd><e:set>
        <e:var n="h"/>,
        <e:plus><e:fst><e:var n="h"/></e:fst><e:snd><e:const n="1"/></e:snd></e:plus>
      </e:set></e:snd>
    </e:in></e:snd>
  </e:and></e:snd>
</e:exists></div></div>
<e:displaycode>  }
  else {&#160;</e:displaycode>
<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><e:or>
  <e:fst><e:or>
    <e:fst><e:pred name="RT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:fst>
    <e:snd><e:pred name="NBT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:snd>
  </e:or></e:fst>
  <e:snd><e:pred name="RVT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:snd>
</e:or></div></div>
<e:displaycode>
    if (root.black) {&#160;</e:displaycode>
<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><e:pred name="NBT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></div></div>

<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'>Weakening</div><e:pred name="BT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></div></div>

<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'>Member of set containing itself</div><e:and>
  <e:fst><e:pred name="BT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:fst>
  <e:snd><e:in>
    <e:fst><e:var n="h"/></e:fst>
    <e:snd><e:set>
      <e:var n="h"/>,
      <e:plus><e:fst><e:var n="h"/></e:fst><e:snd><e:const n="1"/></e:snd></e:plus>
    </e:set></e:snd>
  </e:in></e:snd>
</e:and></div></div>

<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'><m:existsIntro/> on <e:var n="h"/> as <e:var n="nh"/>.</div><e:exists>
  <e:fst><e:var n="nh"/></e:fst>
  <e:snd><e:and>
    <e:fst><e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred></e:fst>
    <e:snd><e:in>
      <e:fst><e:var n="nh"/></e:fst>
      <e:snd><e:set>
        <e:var n="h"/>,
        <e:plus><e:fst><e:var n="h"/></e:fst><e:snd><e:const n="1"/></e:snd></e:plus>
      </e:set></e:snd>
    </e:in></e:snd>
  </e:and></e:snd>
</e:exists></div></div>
<e:displaycode>    }
    else {&#160;</e:displaycode>
<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><e:or>
  <e:fst><e:pred name="RT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:fst>
  <e:snd><e:pred name="RVT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:snd>
</e:or></div></div>
<e:displaycode>
      root.black = true;&#160;</e:displaycode>
<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><e:pred name="BT"><code>root</code>, <e:st n="S"/>, <e:plus><e:fst><e:var n="h"/></e:fst><e:snd><e:const n="1"/></e:snd></e:plus></e:pred></div></div>

<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'>Member of set containing itself</div><e:and>
  <e:fst><e:pred name="BT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></e:fst>
  <e:snd><e:in>
    <e:fst><e:var n="h"/></e:fst>
    <e:snd><e:set>
      <e:var n="h"/>,
      <e:plus><e:fst><e:var n="h"/></e:fst><e:snd><e:const n="1"/></e:snd></e:plus>
    </e:set></e:snd>
  </e:in></e:snd>
</e:and></div></div>

<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'><m:existsIntro/> on <e:var n="h"/> as <e:var n="nh"/>.</div><e:exists>
  <e:fst><e:var n="nh"/></e:fst>
  <e:snd><e:and>
    <e:fst><e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred></e:fst>
    <e:snd><e:in>
      <e:fst><e:var n="nh"/></e:fst>
      <e:snd><e:set>
        <e:var n="h"/>,
        <e:plus><e:fst><e:var n="h"/></e:fst><e:snd><e:const n="1"/></e:snd></e:plus>
      </e:set></e:snd>
    </e:in></e:snd>
  </e:and></e:snd>
</e:exists></div></div>
<e:displaycode>    }&#160;</e:displaycode>
<div class='section'><pre class='indent'>&#160;&#160;&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'>If-rule.</div><e:exists>
  <e:fst><e:var n="nh"/></e:fst>
  <e:snd><e:and>
    <e:fst><e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred></e:fst>
    <e:snd><e:in>
      <e:fst><e:var n="nh"/></e:fst>
      <e:snd><e:set>
        <e:var n="h"/>,
        <e:plus><e:fst><e:var n="h"/></e:fst><e:snd><e:const n="1"/></e:snd></e:plus>
      </e:set></e:snd>
    </e:in></e:snd>
  </e:and></e:snd>
</e:exists></div></div>
<e:displaycode>  }
&#160;</e:displaycode>
<div class='section'><pre class='indent'>&#160;&#160;</pre><div class='AssertionParagraph'><div class='expl'>If-rule. Function postcondition.</div><e:exists>
  <e:fst><e:var n="nh"/></e:fst>
  <e:snd><e:and>
    <e:fst><e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred></e:fst>
    <e:snd><e:in>
      <e:fst><e:var n="nh"/></e:fst>
      <e:snd><e:set>
        <e:var n="h"/>,
        <e:plus><e:fst><e:var n="h"/></e:fst><e:snd><e:const n="1"/></e:snd></e:plus>
      </e:set></e:snd>
    </e:in></e:snd>
  </e:and></e:snd>
</e:exists></div></div>
<e:displaycode>
  return root;
}&#160;</e:displaycode></section>