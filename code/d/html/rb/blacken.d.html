<?xml version="1.0" encoding="UTF-8"?>
<section class="generated_listing" xmlns="http://www.w3.org/1999/xhtml" ns:xi="http://www.w3.org/2001/XInclude" ns:e="http://eegg.github.com/htmlx" xmlns:ns="xmlns" ns:m="http://eegg.github.com/macro"><e:displaycode xmlns:e="http://eegg.github.com/htmlx">module rb.blacken;

import rb.node;

Node* blacken(Node* root) { </e:displaycode><div class="section"><pre class="indent">  </pre><div class="AssertionParagraph"><div class="expl"><div>Function precondition.</div></div><div><e:or xmlns:e="http://eegg.github.com/htmlx">
  <e:pred name="RBT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
  <e:pred name="RVT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
</e:or></div></div></div><e:displaycode xmlns:e="http://eegg.github.com/htmlx">
  if (root == null) { </e:displaycode><div class="section"><pre class="indent">    </pre><div class="AssertionParagraph"><div><e:pred name="ET" xmlns:e="http://eegg.github.com/htmlx"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></div></div></div><div class="section"><pre class="indent">    </pre><div class="AssertionParagraph"><div class="expl"><div>Weakening</div></div><div><e:pred name="BT" xmlns:e="http://eegg.github.com/htmlx"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></div></div></div><div class="section"><pre class="indent">    </pre><div class="AssertionParagraph"><div class="expl"><div>Member of set containing itself</div></div><div><e:and xmlns:e="http://eegg.github.com/htmlx">
  <e:pred name="BT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
  <e:in>
    <e:var n="h"/>
    <e:set>
      <e:var n="h"/>,
      <e:plus><e:var n="h"/><e:const n="1"/></e:plus>
    </e:set>
  </e:in>
</e:and></div></div></div><div class="section"><pre class="indent">    </pre><div class="AssertionParagraph"><div class="expl"><div><m:existsIntro xmlns:m="http://eegg.github.com/macro"/> on <e:var n="h" xmlns:e="http://eegg.github.com/htmlx"/> as <e:var n="nh" xmlns:e="http://eegg.github.com/htmlx"/>.</div></div><div><e:exists xmlns:e="http://eegg.github.com/htmlx">
  <e:vars><e:var n="nh"/></e:vars>
  <e:expr><e:and>
    <e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred>
    <e:in>
      <e:var n="nh"/>
      <e:set>
        <e:var n="h"/>,
        <e:plus><e:var n="h"/><e:const n="1"/></e:plus>
      </e:set>
    </e:in>
  </e:and></e:expr>
</e:exists></div></div></div><e:displaycode xmlns:e="http://eegg.github.com/htmlx">  }
  else { </e:displaycode><div class="section"><pre class="indent">    </pre><div class="AssertionParagraph"><div><e:or xmlns:e="http://eegg.github.com/htmlx">
  <e:or>
    <e:pred name="RT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
    <e:pred name="NBT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
  </e:or>
  <e:pred name="RVT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
</e:or></div></div></div><e:displaycode xmlns:e="http://eegg.github.com/htmlx">
    if (root.black) { </e:displaycode><div class="section"><pre class="indent">      </pre><div class="AssertionParagraph"><div><e:pred name="NBT" xmlns:e="http://eegg.github.com/htmlx"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></div></div></div><div class="section"><pre class="indent">      </pre><div class="AssertionParagraph"><div class="expl"><div>Weakening</div></div><div><e:pred name="BT" xmlns:e="http://eegg.github.com/htmlx"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred></div></div></div><div class="section"><pre class="indent">      </pre><div class="AssertionParagraph"><div class="expl"><div>Member of set containing itself</div></div><div><e:and xmlns:e="http://eegg.github.com/htmlx">
  <e:pred name="BT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
  <e:in>
    <e:var n="h"/>
    <e:set>
      <e:var n="h"/>,
      <e:plus><e:var n="h"/><e:const n="1"/></e:plus>
    </e:set>
  </e:in>
</e:and></div></div></div><div class="section"><pre class="indent">      </pre><div class="AssertionParagraph"><div class="expl"><div><m:existsIntro xmlns:m="http://eegg.github.com/macro"/> on <e:var n="h" xmlns:e="http://eegg.github.com/htmlx"/> as <e:var n="nh" xmlns:e="http://eegg.github.com/htmlx"/>.</div></div><div><e:exists xmlns:e="http://eegg.github.com/htmlx">
  <e:vars><e:var n="nh"/></e:vars>
  <e:expr><e:and>
    <e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred>
    <e:in>
      <e:var n="nh"/>
      <e:set>
        <e:var n="h"/>,
        <e:plus><e:var n="h"/><e:const n="1"/></e:plus>
      </e:set>
    </e:in>
  </e:and></e:expr>
</e:exists></div></div></div><e:displaycode xmlns:e="http://eegg.github.com/htmlx">    }
    else { </e:displaycode><div class="section"><pre class="indent">      </pre><div class="AssertionParagraph"><div><e:or xmlns:e="http://eegg.github.com/htmlx">
  <e:pred name="RT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
  <e:pred name="RVT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
</e:or></div></div></div><e:displaycode xmlns:e="http://eegg.github.com/htmlx">
      root.black = true; </e:displaycode><div class="section"><pre class="indent">      </pre><div class="AssertionParagraph"><div><e:pred name="BT" xmlns:e="http://eegg.github.com/htmlx"><code>root</code>, <e:st n="S"/>, <e:plus><e:var n="h"/><e:const n="1"/></e:plus></e:pred></div></div></div><div class="section"><pre class="indent">      </pre><div class="AssertionParagraph"><div class="expl"><div>Member of set containing itself</div></div><div><e:and xmlns:e="http://eegg.github.com/htmlx">
  <e:pred name="BT"><code>root</code>, <e:st n="S"/>, <e:var n="h"/></e:pred>
  <e:in>
    <e:var n="h"/>
    <e:set>
      <e:var n="h"/>,
      <e:plus><e:var n="h"/><e:const n="1"/></e:plus>
    </e:set>
  </e:in>
</e:and></div></div></div><div class="section"><pre class="indent">      </pre><div class="AssertionParagraph"><div class="expl"><div><m:existsIntro xmlns:m="http://eegg.github.com/macro"/> on <e:var n="h" xmlns:e="http://eegg.github.com/htmlx"/> as <e:var n="nh" xmlns:e="http://eegg.github.com/htmlx"/>.</div></div><div><e:exists xmlns:e="http://eegg.github.com/htmlx">
  <e:vars><e:var n="nh"/></e:vars>
  <e:expr><e:and>
    <e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred>
    <e:in>
      <e:var n="nh"/>
      <e:set>
        <e:var n="h"/>,
        <e:plus><e:var n="h"/><e:const n="1"/></e:plus>
      </e:set>
    </e:in>
  </e:and></e:expr>
</e:exists></div></div></div><e:displaycode xmlns:e="http://eegg.github.com/htmlx">    } </e:displaycode><div class="section"><pre class="indent">    </pre><div class="AssertionParagraph"><div class="expl"><div>If-rule.</div></div><div><e:exists xmlns:e="http://eegg.github.com/htmlx">
  <e:vars><e:var n="nh"/></e:vars>
  <e:expr><e:and>
    <e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred>
    <e:in>
      <e:var n="nh"/>
      <e:set>
        <e:var n="h"/>,
        <e:plus><e:var n="h"/><e:const n="1"/></e:plus>
      </e:set>
    </e:in>
  </e:and></e:expr>
</e:exists></div></div></div><e:displaycode xmlns:e="http://eegg.github.com/htmlx">  }
 </e:displaycode><div class="section"><pre class="indent">  </pre><div class="AssertionParagraph"><div class="expl"><div>If-rule. Function postcondition.</div></div><div><e:exists xmlns:e="http://eegg.github.com/htmlx">
  <e:vars><e:var n="nh"/></e:vars>
  <e:expr><e:and>
    <e:pred name="BT"><code>o</code>, <e:st n="S"/>, <e:var n="nh"/></e:pred>
    <e:in>
      <e:var n="nh"/>
      <e:set>
        <e:var n="h"/>,
        <e:plus><e:var n="h"/><e:const n="1"/></e:plus>
      </e:set>
    </e:in>
  </e:and></e:expr>
</e:exists></div></div></div><e:displaycode xmlns:e="http://eegg.github.com/htmlx">
  return root;
} </e:displaycode></section>