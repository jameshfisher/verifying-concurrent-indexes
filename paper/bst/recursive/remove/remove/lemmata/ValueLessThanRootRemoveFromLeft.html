<section xmlns="http://www.w3.org/1999/xhtml"
	 xmlns:xi="http://www.w3.org/2001/XInclude"
	 xmlns:e="http://eegg.github.com/htmlx"
	 xmlns:m="http://eegg.github.com/macro">

  <e:h><e:logimpl>
      <e:and>
          <e:pred name="TCompose"><e:st n="L"/>, <e:var n="v"/>, <e:st n="R"/>, <e:st n="S"/></e:pred>
          <e:lt><e:var n="w"/><e:var n="v"/></e:lt>
      </e:and>
      <e:pred name="TCompose">
	  <e:setminus><e:st n="L"/><e:set><e:var n="w"/></e:set></e:setminus>,
	  <e:var n="v"/>, <e:st n="R"/>,
	  <e:setminus><e:st n="S"/><e:set><e:var n="w"/></e:set></e:setminus>
      </e:pred>
  </e:logimpl></e:h>

  <div class="display"><xi:include href="./ValueLessThanRootRemoveFromLeft.svg" /></div>

  <e:derivation>
    <e:step name="given">
      <e:derive><e:and>
          <e:pred name="TCompose"><e:st n="L"/>, <e:var n="v"/>, <e:st n="R"/>, <e:st n="S"/></e:pred>
          <e:lt><e:var n="w"/><e:var n="v"/></e:lt>
      </e:and></e:derive>
      <e:by>given</e:by>
    </e:step>

    <e:step name="givenCompose">
      <e:derive><e:pred name="TCompose"><e:st n="L"/>, <e:var n="v"/>, <e:st n="R"/>, <e:st n="S"/></e:pred></e:derive>
      <e:by><e:from name="given"/>, <m:andElim/></e:by>
    </e:step>

    <e:step name="givenlt">
      <e:derive><e:lt><e:var n="w"/><e:var n="v"/></e:lt></e:derive>
      <e:by><e:from name="given"/>, <m:andElim/></e:by>
    </e:step>

    <e:step name="openCompose">
      <e:derive><e:and type="lines">
	  <e:eq>
	    <e:union>
	      <e:st n="L"/>
	      <e:set><e:var n="v"/></e:set>
	      <e:st n="R"/>
	    </e:union>
	    <e:st n="S"/>
	  </e:eq>
	<e:forall>
	  <e:vars>
	    <e:in><e:var n="l"/><e:st n="L"/></e:in>
	  </e:vars>
	  <e:expr>
	    <e:lt><e:var n="l"/><e:var n="v"/></e:lt>
	  </e:expr>
	</e:forall>
	<e:forall>
	  <e:vars>
	    <e:in><e:var n="r"/><e:st n="R"/></e:in>
	  </e:vars>
	  <e:expr>
	    <e:lt><e:var n="v"/><e:var n="r"/></e:lt>
	  </e:expr>
	</e:forall>
      </e:and></e:derive>
      <e:by><e:from name="givenCompose"/>, open predicate</e:by>
    </e:step>

    <e:step name="LUvURIsS">
      <e:derive><e:eq>
	    <e:union>
	      <e:st n="L"/>
	      <e:set><e:var n="v"/></e:set>
	      <e:st n="R"/>
	    </e:union>
	    <e:st n="S"/>
      </e:eq></e:derive>
      <e:by><e:from name="openCompose"/>, <m:andElim/></e:by>
    </e:step>

    <e:step name="AllInLLessThanv">
      <e:derive><e:forall>
	  <e:vars>
	    <e:in><e:var n="l"/><e:st n="L"/></e:in>
	  </e:vars>
	  <e:expr>
	    <e:lt><e:var n="l"/><e:var n="v"/></e:lt>
	  </e:expr>
      </e:forall></e:derive>
      <e:by><e:from name="openCompose"/>, <m:andElim/></e:by>
    </e:step>

    <e:step name="AllInRGreaterThanv">
      <e:derive><e:forall>
	  <e:vars>
	    <e:in><e:var n="r"/><e:st n="R"/></e:in>
	  </e:vars>
	  <e:expr>
	    <e:lt><e:var n="v"/><e:var n="r"/></e:lt>
	  </e:expr>
      </e:forall></e:derive>
      <e:by><e:from name="openCompose"/>, <m:andElim/></e:by>
    </e:step>

    <e:step name="(LUvUR)minuswIsSminusw">
      <e:derive><e:eq>
	    <e:setminus>
	      <e:union parens="yes">
		<e:st n="L"/>
		<e:set><e:var n="v"/></e:set>
		<e:st n="R"/>
	      </e:union>
	      <e:set><e:var n="w"/></e:set>
	    </e:setminus>
	    <e:setminus><e:st n="S"/><e:set><e:var n="w"/></e:set></e:setminus>
      </e:eq></e:derive>
      <e:by><e:from name="LUvURIsS"/>, <m:sameOp/></e:by>
    </e:step>

    <e:step name="distrib">
      <e:derive><e:eq>
	  <e:union>
	    <e:setminus parens="yes"><e:st n="L"/><e:set><e:var n="w"/></e:set></e:setminus>
	    <e:setminus parens="yes"><e:set><e:var n="v"/></e:set><e:set><e:var n="w"/></e:set></e:setminus>
	    <e:setminus parens="yes"><e:st n="R"/><e:set><e:var n="w"/></e:set></e:setminus>
	  </e:union>
	  <e:setminus><e:st n="S"/><e:set><e:var n="w"/></e:set></e:setminus>
      </e:eq></e:derive>
      <e:by><e:from name="(LUvUR)minuswIsSminusw"/>, <m:distribSetminusUnion/></e:by>
    </e:step>

    <e:step name="RminuswIsR">
      <e:derive><e:eq>
	  <e:setminus><e:st n="R"/><e:set><e:var n="w"/></e:set></e:setminus>
	  <e:st n="R"/>
      </e:eq></e:derive>
      <e:by>??</e:by>
    </e:step>

    <e:step name="vminuswIsv">
      <e:derive><e:eq>
	  <e:setminus><e:set><e:var n="v"/></e:set><e:set><e:var n="w"/></e:set></e:setminus>
	  <e:set><e:var n="v"/></e:set>
      </e:eq></e:derive>
      <e:by>??</e:by>
    </e:step>

    <e:step name="LminuswUvURIsSminusw">
      <e:derive><e:eq>
	  <e:union>
	    <e:setminus parens="yes"><e:st n="L"/><e:set><e:var n="w"/></e:set></e:setminus>
	    <e:set><e:var n="v"/></e:set>
	    <e:st n="R"/>
	  </e:union>
	  <e:setminus><e:st n="S"/><e:set><e:var n="w"/></e:set></e:setminus>
      </e:eq></e:derive>
      <e:by><e:from name="distrib"/>, <e:from name="RminuswIsR"/>, <e:from name="vminuswIsv"/>, substitution</e:by>
    </e:step>

    <e:step name="AllInLminuswLessThanv">
      <e:derive><e:forall>
	  <e:vars>
	    <e:in><e:var n="l"/><e:setminus parens="yes"><e:st n="L"/><e:set><e:var n="w"/></e:set></e:setminus></e:in>
	  </e:vars>
	  <e:expr>
	    <e:lt><e:var n="l"/><e:var n="v"/></e:lt>
	  </e:expr>
      </e:forall></e:derive>
      <e:by><e:from name="AllInLLessThanv"/>, <m:AllMembersThenAllMembersOfSubset/></e:by>
    </e:step>

    <e:step name="composeParts">
      <e:derive><e:and type="lines">
	  <e:eq>
	    <e:union>
	      <e:setminus parens="yes"><e:st n="L"/><e:set><e:var n="w"/></e:set></e:setminus>
	      <e:set><e:var n="v"/></e:set>
	      <e:st n="R"/>
	    </e:union>
	    <e:setminus><e:st n="S"/><e:set><e:var n="w"/></e:set></e:setminus>
	  </e:eq>
	<e:forall>
	  <e:vars>
	    <e:in><e:var n="l"/><e:setminus><e:st n="L"/><e:set><e:var n="w"/></e:set></e:setminus></e:in>
	  </e:vars>
	  <e:expr>
	    <e:lt><e:var n="l"/><e:var n="v"/></e:lt>
	  </e:expr>
	</e:forall>
	<e:forall>
	  <e:vars>
	    <e:in><e:var n="r"/><e:st n="R"/></e:in>
	  </e:vars>
	  <e:expr>
	    <e:lt><e:var n="v"/><e:var n="r"/></e:lt>
	  </e:expr>
	</e:forall>
      </e:and></e:derive>
      <e:by><e:from name="LminuswUvURIsSminusw"/>, <e:from name="AllInLminuswLessThanv"/>, <e:from name="AllInRGreaterThanv"/>, <m:andIntro/></e:by>
    </e:step>

    <e:step name="qed">
      <e:derive><e:pred name="TCompose">
	  <e:setminus><e:st n="L"/><e:set><e:var n="w"/></e:set></e:setminus>,
	  <e:var n="v"/>, <e:st n="R"/>,
	  <e:setminus><e:st n="S"/><e:set><e:var n="w"/></e:set></e:setminus>
      </e:pred></e:derive>
      <e:by><e:from name="composeParts"/>, close predicate</e:by>
    </e:step>
  </e:derivation>

</section>
