<section xmlns="http://www.w3.org/1999/xhtml"
	 xmlns:xi="http://www.w3.org/2001/XInclude"
	 xmlns:e="http://eegg.github.com/htmlx"
	 xmlns:m="http://eegg.github.com/macro">

    <e:h>A recursive <m:llrb/> <code>insert</code> algorithm</e:h>

    <p>
      <e:specification>
	<e:caption>The <code>insert</code> procedure.</e:caption>
	<e:contents>
	  <e:triple>
	    <e:pre><e:and>
		<e:pred name="B">
		  <e:ptr n="r"/>
		  <e:var n="h"/>
		  <e:st n="S"/>
		  <e:var n="lb"/>
		  <e:var n="hb"/>
		</e:pred>
		<e:lt>
		  <e:var n="lb"/>
		  <code>value</code>
		  <e:var n="hb"/>
		</e:lt>
	    </e:and></e:pre>
	    <e:command>nr = insert(r, value);</e:command>
	    <e:post><e:and>
		<e:pred name="RB">
		  <e:ptr n="nr"/>
		  <e:var n="h'"/>
		  <e:union>
		    <e:st n="S"/>
		    <e:set><code>value</code></e:set>
		  </e:union>
		  <e:var n="lb"/>
		  <e:var n="hb"/>
	    </e:pred>
		<e:or parens="yes">
		  <e:eq><e:var n="h'"/><e:var n="h"/></e:eq>
		  <e:eq><e:var n="h'"/><e:plus><e:var n="h"/><e:const n="1"/></e:plus></e:eq>
		</e:or>
	    </e:and></e:post>
	  </e:triple>
	</e:contents>
      </e:specification>
    </p>

    <e:diagram>
      <e:caption>The <code>insert</code> procedure.</e:caption>
      <e:contents><xi:include href="./insert.svg" /></e:contents>
    </e:diagram>

    <p>
      <e:specification>
	<e:caption>The <code>blacken</code> procedure, first specification.</e:caption>
	<e:contents>
	  <e:triple>
	    <e:pre>
	      <e:pred name="RV">
		<e:ptr n="r"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	      </e:pred>
	    </e:pre>
	    <e:command>blacken(r);</e:command>
	    <e:post><e:pred name="B3">
		<e:ptr n="r"/>
		<e:plus><e:var n="h"/><e:const n="1"/></e:plus>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	    </e:pred></e:post>
	  </e:triple>
	</e:contents>
      </e:specification>
    </p>


    <p>
      <e:specification>
	<e:caption>The <code>blacken</code> procedure, second specification.</e:caption>
	<e:contents>
	  <e:triple>
	    <e:pre>
	      <e:pred name="R">
		<e:ptr n="r"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	      </e:pred>
	    </e:pre>
	    <e:command>blacken(r);</e:command>
	    <e:post><e:pred name="B2">
		<e:ptr n="r"/>
		<e:plus><e:var n="h"/><e:const n="1"/></e:plus>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	    </e:pred></e:post>
	  </e:triple>
	</e:contents>
      </e:specification>
    </p>

    <e:diagram>
      <e:caption>The <code>blacken</code> procedure.</e:caption>
      <e:contents><xi:include href="./blacken.svg" /></e:contents>
    </e:diagram>

    <p>
      <e:specification>
	<e:caption>The <code>elimB4</code> procedure.</e:caption>
	<e:contents>
	  <e:triple>
	    <e:pre>
	      <e:pred name="B4">
		<e:ptr n="r"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	      </e:pred>
	    </e:pre>
	    <e:command>blacken(r);</e:command>
	    <e:post><e:pred name="R">
		<e:ptr n="r"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	    </e:pred></e:post>
	  </e:triple>
	</e:contents>
      </e:specification>
    </p>

    <e:diagram>
      <e:caption>The <code>elim4</code> procedure.</e:caption>
      <e:contents><xi:include href="./elim4.svg" /></e:contents>
    </e:diagram>


    <p>
      <e:specification>
	<e:caption>The <code>rotateLeft</code> procedure, first specification.</e:caption>
	<e:contents>
	  <e:triple>
	    <e:pre>
	      <e:pred name="RLB3">
		<e:ptr n="r"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	      </e:pred>
	    </e:pre>
	    <e:command>blacken(r);</e:command>
	    <e:post><e:pred name="B3">
		<e:ptr n="r"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	    </e:pred></e:post>
	  </e:triple>
	</e:contents>
      </e:specification>
    </p>

    <e:diagram>
      <e:caption>The <code>rotateLeft</code> procedure, first specification.</e:caption>
      <e:contents><xi:include href="./rotateLeftB3.svg" /></e:contents>
    </e:diagram>

    <p>
      <e:specification>
	<e:caption>The <code>rotateLeft</code> procedure, second specification.</e:caption>
	<e:contents>
	  <e:triple>
	    <e:pre>
	      <e:pred name="RLRV">
		<e:ptr n="r"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	      </e:pred>
	    </e:pre>
	    <e:command>blacken(r);</e:command>
	    <e:post><e:pred name="RV">
		<e:ptr n="r"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	    </e:pred></e:post>
	  </e:triple>
	</e:contents>
      </e:specification>
    </p>

    <e:diagram>
      <e:caption>The <code>rotateLeft</code> procedure, second specification.</e:caption>
      <e:contents><xi:include href="./rotateLeftRV.svg" /></e:contents>
    </e:diagram>

    <p>
      <e:specification>
	<e:caption>The <code>rotateRight</code> procedure.</e:caption>
	<e:contents>
	  <e:triple>
	    <e:pre>
	      <e:pred name="thing with RV on the left hand side">
		<e:ptr n="r"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	      </e:pred>
	    </e:pre>
	    <e:command>nr = rotateRight(r);</e:command>
	    <e:post><e:pred name="RV">
		<e:ptr n="nr"/>
		<e:var n="h"/>
		<e:st n="S"/>
		<e:var n="lb"/>
		<e:var n="hb"/>
	    </e:pred></e:post>
	  </e:triple>
	</e:contents>
      </e:specification>
    </p>

    <e:diagram>
      <e:caption>The <code>rotateRight</code> procedure.</e:caption>
      <e:contents><xi:include href="./rotateRight.svg" /></e:contents>
    </e:diagram>

<!--    <p>
      The annotated code for recursive <code>insert</code> follows.

      <e:annotation>
	<e:caption>Recursive <code>insert</code>.</e:caption>
	<e:contents><xi:include href="../../../../code/d/html/ll/insert/recursive.d.html"/></e:contents>
      </e:annotation>
    </p>-->
</section>
